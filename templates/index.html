<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Siigo Lightning Out</title>
  <!-- Carga el runtime desde tu Experience -->
  <script src="{{ site_domain }}/lightning/lightning.out.js"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif; }
    .container { max-width: 1100px; margin: 24px auto; padding: 0 12px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Siigo Record Viewer (Lightning Out)</h2>
    <div id="siigo_container"></div>
  </div>

  <script>
    // Variables del servidor (Flask) para pasar al componente
    const recordId   = "{{ record_id }}";          // vacío => modo "desconocido"
    const objectName = "{{ object_api }}";         // 'Lead' | 'Account' | 'desconocido'
    const baseDomain = "{{ base_domain }}";        // dominio core (para forzar login si no hay sesión)
    const siteDomain = "{{ site_domain }}";        // dominio del Experience

    // Usa la app Lightning Out de tu org (debes crearla como ltng:outApp con deps a tus LWC)
    $Lightning.use("c:SiigoOutApp",
      function () {
        // Componente Aura host que envuelve al LWC y acepta los attrs
        $Lightning.createComponent(
          "c:SiigoUiRecordViewerHost",
          { recordId: recordId, objectApiName: objectName, baseDomain: baseDomain },
          "siigo_container",
          function (cmp) { console.log("Siigo Viewer cargado"); }
        );
      },
      siteDomain // <<— endpoint del Experience (no el core)
    );
  </script>
</body>
</html>